# DSL KeyPad — многоязычный ввод и ввод более 4200 символов Юникода на базовых QWERTY/ЙЦУКЕН

**Содержание**
 • [Краткий экскурс](#Краткий-экскурс)
 • [Краткий перечень возможностей](#Краткий-перечень-возможностей)
 • [Подробнее об основных возможностях](#Подробнее-об-основных-возможностях)
 • [Интерфейс](#Интерфейс)
 • [Установка и репозиторий](#Установка-и-репозиторий)
 • [Ограничения и нюансы](#Ограничения-и-нюансы)

Представленная программка — инструмент, дающий пользователю возможность вводить широкий спектр символов посредством ряда методов, описанных ниже. Основной фокус —расширение охвата латиницы и кириллицы без необходимости наличия в системе отдельных языковых раскладок, помимо английской и русской.

_Написана на AutoHotkey v2_

![GUI с представлением списка доступных символов с их хоткеями или «рецептами» (см. далее)](https://raw.githubusercontent.com/DemerNkardaz/DSL-KeyPad/refs/heads/dev/webpage/media/panel_forge_tab_ru.png)

## Краткий экскурс

<anchor>Краткий-экскурс</anchor>

Инструмент родился из собственной нужды к использованию «нестандартных» символов. Сначала я пользовалась «[Типографской раскладкой](https://ilyabirman.ru/typography-layout/)» Ильи Бирмана (и пользуюсь по сей день в паре со своим инструментом), однако этого мне оказалось мало — она не давала мне всего необходимого.

Я искала и пробовала другие решения — например, [WinCompose](https://github.com/samhocevar/wincompose), — но по итогу это привело меня к мысли «всё не совсем то». К тому моменту я уже занималась написанием своего, тогда ещё простого, скрипта. Я решила продолжить его развивать, ведь никто не сделает инструмент наиболее удобный для меня, чем я сама.

Первая версия была до банальности примитивной, ~20 биндов формата обычных привязок:

```ahk
<^<!m:: Send("{U+0304}") ; Combining macron
<^<!b:: Send("{U+0306}") ; Combining breve
…
<^>!>+1:: Send("{U+2003}") ; Em Space
<^>!>+2:: Send("{U+2002}") ; En Space
…
<^<!e::　Send("{U+045E}") ; (Ў)
…
```

Однако со временем мою голову начали посещать всё новые идеи и желание хотя бы попробовать их реализовать. Желание сделать что-то сложнее, разнообразнее, и что могло бы охватить все мои потенциальные символьные хотелки. Как итог — процесс, конечно, сильно затянулся, да получился какой-то монструозный ООП’оид, но результатом я относительно довольна (есть что улучшать, и я буду это улучшать по мере возможности).

Думаю тут же следует упомянуть, что я, конечно, не программист — максимум кодер. В начале разработки так вообще была утёнком тем ещё и бегала частенько к нейронке (с которой, однако, контакт заладился плохо — не умел гпт с автохоткеем нормально помочь… и хорошо — лишний пинок самой думать над кодом).

## Краткий перечень возможностей

<anchor>Краткий-перечень-возможностей</anchor>

[↓ к подробным описаниям](#Подробнее-об-основных-возможностях)

- Как описано в заголовке — поддержка более 4200 символов Юникода, включая: пунктуацию, математические символы, символы валют, специальные символы, алхимические и т.д.
- «Многослойный» набор привязок, в основном — раздельных для английского и русского языков ([англ.] `RAlt + A` → &Abreve;, `RAlt + Z` → &Zdot;; [рус.] `RAlt + Ф` → &#1138;, `RAlt + Я` → &#1126;) (по умолчанию отключены, переключаются на `RAlt F1`).
- Режим композиции — активируется двойным нажатием `RAlt` и позволяет получать одни символы из последовательности других («рецепта») (AE → &AElig;; OE → &OElig;; A&#9676;&#774;&#9676;&#769; → &#7854;; &Iukcy;&#1130; → &#1132;; ДЧ → &#1324;).
- Альтернативные режимы ввода для форм письменности, отличных от латиницы и кириллицы ([греческая письменность](https://ru.wikipedia.org/wiki/Греческий_алфавит), [руническая](https://ru.wikipedia.org/wiki/Руны), [глаголица](https://ru.wikipedia.org/wiki/Глаголица), [финикийская](https://ru.wikipedia.org/wiki/Финикийское_письмо), [этрусская](https://en.wikipedia.org/wiki/Old_Italic_scripts), [тюркская](https://ru.wikipedia.org/wiki/Древнетюркское_письмо), [пермская](https://ru.wikipedia.org/wiki/Древнепермское_письмо) и пр. виды письменности; включает и [Международный фонетический алфавит](https://ru.wikipedia.org/wiki/Международный_фонетический_алфавит)).
- Вариация глифов — режимы, позволяющие вводить альтернативные варианты символов (A → &#7468; &#119860; &#119808; &#119912; &#120224; &#120328; &#120276; &#120380; &#120432; &#7424; &Afr; &#120172; &Ascr; &#120016; &Aopf;). Работают похожим образом с предыдущим пунктом, но чуть-чуть иначе (см. в [подробном описании](#Вариация-глифов)).
- Переключение режима ввода между символами Юникода \[`Ă Ǣ`\], HTML-энтити/мнемоники \[`&Abreve; &#482;`\] и LaTeX \[`\u{A} \={\AE}`\] (если LaTeX кода нет — введёт символ Юникода) (`RAlt RShift F1`).
- Поиск символов по «тегам». У большинства из символов локальной библиотеки есть два и более тегов, по сути, представляющих из себя варианты названий, которые можно вводить как полностью, так и частично, чтобы получить результат (`прописная буква Еры глаголицы` или `гла еры` → &#11295;&#11274;).
- Внутренние раскладки клавиатуры, позволяющие использовать отличное от QWERTY/ЙЦУКЕН расположение привязок.
- Поддержка пользовательских рецептов для режима композиции.
- Поддержка пользовательских привязок (ограничено символами библиотеки и пользовательскими рецептами).
- Вспомогательные TELEX/VNI-подобные режимы ввода для [вьетнамского языка](https://ru.wikipedia.org/wiki/Куокнгы) (с щепоткой [джарайского](https://ru.wikipedia.org/wiki/Джарайский_язык)) и для [пиньиня](https://ru.wikipedia.org/wiki/Пиньинь).
- Мини-режимы для ввода надстрочных/подстрочных символов цифрового ряда (`LWin LAlt + ↑/↓`), при этом `CapsLock` зеркалит вводимые символы (при активном надстрочном режиме — активация `CapsLock` заставит вводиться подстрочные, и наоборот).
- Мини-режим для ввода римских цифр (отдельных символов Юникода) (`LWin LAlt RShift + ↑`): &#8544;&#8545;&#8546;&#8547;&#8548;&#8549;&#8550;&#8551;&#8552;&#8553;&#8554;&#8555;…
- Возможность добавлять символы в избранное двойным нажатием `ЛКМ` с зажатым `LShift` в GUI со списком доступных символов, их комбинаций и рецептов. Избранный символ будет выделяться в списке символом &#x2605;, а его рецепт (если он есть) будет всегда отображаться в подсказке режима композиции.
- И другие, менее значимые возможности…

## Подробнее об основных возможностях

<anchor>Подробнее-об-основных-возможностях</anchor>

### Многослойные привязки, они же «Быстрые ключи»

Вероятно, самое страшное. Их много, невероятно много, и опытный пианист, безусловно, справится с ними. Если верить `.HotKeysCount()`’у, то их более шестисот. На каждую клавишу может приходиться до 10–11-ти возможных комбинаций (если не считать комбинации с активным CapsLock за отдельные), но в среднем их около восьми (латинская I в этом чемпион: &#300; &Iuml; &Imacr; &Itilde; &Icirc; &#463; &Iogon; &Idot; &Iacute; &Igrave; &#520;).

В случае необходимости их можно отключить (или включить) через `RAlt + F1`. Состояние вкл/выкл сохраняется в файле настроек.

Стоит отметить, что инструмент создавался под полноразмерную клавиатуру — со стрелками, нампадом и т.д. Это может вызывать неудобства у пользователей других вариантов клавиатур, однако при необходимости это можно сгладить через пользовательские привязки.

Некоторые комбинации были унаследованы от «Типографской раскладки»:

- `RAlt + Точка (/)` — вводит многоточие \[ … \],
- `RAlt + 1 | 7` — вводят перевёрнутые восклицательный и вопросительный знак \[ &iexcl; &iquest; \],
- `RAlt + 5` — вводит промилле \[ &permil; \],
- `RAlt LAlt + 8` — вводит символ бесконечности \[ &infin; \] (оригинальную комбинацию занял символ умножения \[ &times; \], а потому для бесконечности в неё был добавлен левый Альт),
- `RAlt *(LShift) + Дефисо-минус` — вводят длинное и короткое тире \[ &mdash; &ndash; \],
- `RAlt + Равно` — \[ &ne; \],
- `RAlt + Пробел` — неразрывный пробел \[ <u> </u> \].

Комбинации для вставки кавычек унаследованы ввиде `Б (<)` и `Ю (>)` как и в «Типографской раскладке», но имеют несколько отличное поведение:

- `RAlt + Б (<) | Ю (>)` — вводят \[ « » \], если активен русский язык, или \[ “ ” \], если активен английский,
- `RAlt LAlt + Б (<) | Ю (>)` — тоже, что и предыдущее, но языки поменялись местами,
- `RAlt LShift + Б (<) | Ю (>)` — вводят \[ „ “ \], если активен русский язык, или \[ ‘ ’ \], если активен английский,
- `` RAlt RShift + Ё (`) `` — дополнительная комбинация под \[ ’ \] для использования в качестве апострофа.

Примеры уже собственных привязок:

- `RAlt + Клавиши стрелок` — \[ ←↑↓→ \],
- `RAlt + Пары клавиш стрелок (влево-вверх, вправо-вверх, влево-вниз и т.д.)` — \[ ↖↗↙↘↔↕ \],
- `RAlt LShift + Клавиши стрелок` — \[ ⮌⮍⮏⮎ \],
- `RAlt RShift + Клавиши стрелок влево/вправо` — \[ ↺↻ \],
- `RAlt RShift + Пробел` — круглая шпация \[ <u>&emsp;</u> \],
- `RAlt LShift + Пробел` — полукруглая шпация \[ <u>&ensp;</u> \],
- `RAlt LAlt + Пробел` — тонкая шпация \[ <u>&thinsp; </u> \],
- `RAlt + 9 | 0` — \[ ⟨ ⟩ \],
- `RAlt + [ | ]` — \[ ⁅ ⁆ \],
- `RAlt LAlt LShift RShift + [ | ]` — \[ 《 》 \],
- `RShift *(CapsLock) + 1` — \[ &#8253; &#11800; \].

Дополнительно есть «Вторичные» и «Третичные ключи», активируемые через `RAlt LAlt + F1` и `RAlt LAlt + F2` соответственно. Это дополнительные привязки для символов, которые не влезли в основной пул, но очень хотелось. Они пришли на замену са́мой первой «механике» инструмента — «Группам активации», которая для текущего состояния программы оказалась нерелевантной: необходимо было нажать комбинацию для активации одной из «групп», а затем ввести символьный ключ желаемого знака.

Отключаются эти ключи повторным нажатием их комбинации, а состояние сохраняется в файле настроек.

### Внутренние раскладки клавиатуры

Возможно они могли бы показаться лишними, но они необходимы, так как привязки прибиваются гвоздями к скан-кодам клавиш (что я посчитала более надёжным, чем к «абстракции» в виде буквы/названия клавиши). В следствие этого переключение системной раскладки на, например, Dvorak/Диктор не изменит положение привязок программы. Однако в настройках можно выбрать соответствующие внутренние раскладки и тогда привязки будут на корректных местах для отличных от QWERTY/ЙЦУКЕН раскладок.

Если в программе нет подходящей раскладки — её можно создать самому через `<ФАЙЛ>.ini` «разметку» в `<ПРОГРАММА>\User\profile-<ПРОФИЛЬ>\CustomLayouts\` со следующей структурой:

```ini
[info]
name=AZERTY ; название
type=Latin ; Latin если для английского, Cyrillic если для русского языка
[keys]
A=SC010 ; поддерживает как прямое указание скан-кода
Z=SC011
; …
Q=A ; так и имя клавиши на QWERTY/ЙЦУКЕН раскладке
```

```ini
[info]
name=КВЕРТИ
type=Cyrillic
[keys]
К=Й
В=Ц
; …
А=Ф
С=Ы
Ф=А
```

## Интерфейс

<anchor>Интерфейс</anchor>

## Установка и репозиторий

<anchor>Установка-и-репозиторий</anchor>

## Ограничения и нюансы

<anchor>Ограничения-и-нюансы</anchor>

1. Программа ограничена работой на английских и русских раскладках. При обнаружении другого языка клавиатуры (например, японский) — все привязки автоматически приостановятся, так как будут мешать этому языку (в примере с японским — невозможность использовать катакану при зажатии <kbd>LShift</kbd>). При возврате на английский/русский — автоматически восстановятся.<br><br>Помимо «English (США)» и «Русский (Россия)» программа будет работать и на следующих языковых раскладках: Русский — Беларусь, Молдова, Украина, Казахстан, Кыргызстан; Английский — Канада, Великобритания, Ирландия, Австралия, Сингапур, ОАЭ, Новая Зеландия, Белиз, Филлипины, Ямайка, Карибские острова, Южная Африка, Зимбабве, Тринидад и Тобаго. Привязки для английского языка будут работать и на вьетнамской языковой раскладке, и даже относительно совместимы с родным TELEX’ом: <kbd>RAlt + A, S</kbd> даёт `Ắ`, как при обычном вводе <kbd>A, W, S</kbd> (но не во всех приложениях).

2. Не все привязки могут работать на той или иной мембранной клавиатуре. Полноценно проверить работоспособность привязок на механической клавиатуре не удалось (по причине её полурабочего состояния), но она помогла понять, что некоторые привязки не работают из-за основной, мембранной, клавиатуры, а не косяка в коде.
